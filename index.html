<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arsip</title>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-storage.js"></script>
    <style>
         body{
          background-color: lightgrey;
         }
        .progress-bar {
            width: 0;
            height: 25px;
            background-color: #4caf50;
            text-align: center;
            color: white;
            line-height: 25px;
        }
        h2{
          text-align: center;
          color: black;
        }
        .progress-container {
            width: 100%;
            background-color: #ddd;
        }
        .notification {
            padding: 10px;
            color: white;
            display: none;
            margin-top: 10px;
        }
        .success {
            background-color: #4caf50;
        }
        .error {
            background-color: #f44336;
        }
    </style>
</head>
<body>
    <h2>Upload file!</h2>

    <input type="file" id="photoInput" accept="image/*" />
    <button onclick="uploadPhoto()">Upload Foto</button>

    <div class="progress-container">
        <div id="progressBar" class="progress-bar"></div>
    </div>

    <p id="uploadStatus"></p>

    <div id="notification" class="notification"></div>

    <script>
        // Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyDQPW-eoALjPJzjMJwMkXtfgFjGyiaBCZA",
  authDomain: "arsip-photos.firebaseapp.com",
  projectId: "arsip-photos",
  storageBucket: "arsip-photos.appspot.com",
  messagingSenderId: "114304547421",
  appId: "1:114304547421:web:3d9d8f52c701f240986bb4",
  measurementId: "G-TC57225926"
};

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const storage = firebase.storage();

        function showNotification(message, isSuccess) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';
            notification.className = isSuccess ? 'notification success' : 'notification error';
            
            // Hide notification after 5 seconds
            setTimeout(() => {
                notification.style.display = 'none';
            }, 5000);
        }

        function uploadPhoto() {
            const fileInput = document.getElementById('photoInput');
            const file = fileInput.files[0];
            const progressBar = document.getElementById('progressBar');
            const uploadStatus = document.getElementById('uploadStatus');
            
            if (file) {
                const storageRef = storage.ref('photos/' + file.name);
                const uploadTask = storageRef.put(file);

                uploadTask.on('state_changed',
                    (snapshot) => {
                        const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                        progressBar.style.width = progress + '%';
                        progressBar.textContent = Math.floor(progress) + '%';
                        uploadStatus.textContent = 'Proses upload...';
                    },
                    (error) => {
                        console.error('Upload failed:', error);
                        showNotification('Upload gagal: ' + error.message, false);
                        uploadStatus.textContent = 'Upload gagal!';
                    },
                    () => {
                        uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
                            showNotification('Upload berhasil! File tersedia di: ' + downloadURL, true);
                            uploadStatus.textContent = 'Upload berhasil!';
                            progressBar.style.width = '0%'; // Reset progress bar
                        });
                    }
                );
            } else {
                alert('Pilih foto untuk diupload!');
            }
        }
    </script>
</body>
</html>
